version: 2
jobs:
  build:
    docker:
        - image: circleci/node:9
    steps:
        - checkout
        - restore_cache:
            name: Restore yarn cache
            key: node-modules-{{ .Branch }}-{{ checksum "yarn.lock" }}
        - run:
            name: Install modules
            command: yarn --frozen-lockfile install
        - save_cache:
            name: Save yarn cache
            key: node-modules-{{ .Branch }}-{{ checksum "yarn.lock" }}
            paths:
                - node_modules
        - run:
            name: Build
            command: yarn build
        - run:
            name: Tests
            command: yarn test
